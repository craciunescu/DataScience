\documentclass[a4paper]{article}
\usepackage[utf8]{inputenc}
\usepackage[english]{babel}



\title{G4.P-1}
\author{David Emanuel Craciusecu y Laura PÃ©rez Medeiro}


\usepackage{Sweave}
\begin{document}


\maketitle
The test laboratory will be divided into two parts:

1. An exercise mentored by the teacher, in which all the contents explained
in the fisrt unit will be revised. The files used in this exercise are:

	1.1 "Satelites.txt", which contains information about the different ratious of Uranus' moons.
	The aim of the exercise is obtained the same result as we get into the theorical class. 
	
\begin{Schunk}
\begin{Sinput}
> while (!"satelites.txt" %in% list.files(getwd()))
+ {
+   print("Data file not found. Add \"satelites.txt\" to the current directory.")
+   invisible(readline(prompt="Press [enter] to continue"))
+ }
> 	satelites <- read.table("satelites.txt")
> 	satelites
\end{Sinput}
\begin{Soutput}
           nombre radio
1        CORDELIA    13
2          OFELIA    16
3          BIANCA    22
4         CRESIDA    33
5       LESDEMONA    39
6         JULIETA    42
7       ROSALINDA    27
8         BELINDA    34
9  LUNA-1986U1020    20
10       CALIBANO    30
11       LUNA-119    20
12     LUNA_119U2    15
\end{Soutput}
\begin{Sinput}
> 	radius <- satelites $radio
> 	radius
\end{Sinput}
\begin{Soutput}
 [1] 13 16 22 33 39 42 27 34 20 30 20 15
\end{Soutput}
\end{Schunk}

It is important to take into account that the working directory must be the same to the file's
directory when read.table is going to be used. Otherwise, we must indicate the absolute route where
the file is.
	
After reading the data, different analyzes will be applied to those Uranus' moon radius:
	
		a) Calculate absolute and relative satellite radius frequencies:

ABSOLUTE FRECUENCY:
\begin{Schunk}
\begin{Sinput}
> absoluteFreq    <- function(set) {table(set)}
> absoluteFreq(radius)
\end{Sinput}
\begin{Soutput}
set
13 15 16 20 22 27 30 33 34 39 42 
 1  1  1  2  1  1  1  1  1  1  1 
\end{Soutput}
\end{Schunk}
ACUMULATIVE ABSOLUTE FRECUENCY:
\begin{Schunk}
\begin{Sinput}
> cumAbsoluteFreq <- function(set) {cumsum(absoluteFreq(set))}
> cumAbsoluteFreq(radius)
\end{Sinput}
\begin{Soutput}
13 15 16 20 22 27 30 33 34 39 42 
 1  2  3  5  6  7  8  9 10 11 12 
\end{Soutput}
\end{Schunk}
RELATIVE FRECUENCY
\begin{Schunk}
\begin{Sinput}
> relativeFreq <- function(set) {table(set) / length(set)}
> relativeFreq(radius)
\end{Sinput}
\begin{Soutput}
set
        13         15         16         20         22         27         30         33         34 
0.08333333 0.08333333 0.08333333 0.16666667 0.08333333 0.08333333 0.08333333 0.08333333 0.08333333 
        39         42 
0.08333333 0.08333333 
\end{Soutput}
\end{Schunk}
ACUMULATIVE RELATIVE FRECUENCY
\begin{Schunk}
\begin{Sinput}
> cumRelativeFreq <- function(set) {cumsum(relativeFreq(set))}
> cumRelativeFreq(radius)
\end{Sinput}
\begin{Soutput}
        13         15         16         20         22         27         30         33         34 
0.08333333 0.16666667 0.25000000 0.41666667 0.50000000 0.58333333 0.66666667 0.75000000 0.83333333 
        39         42 
0.91666667 1.00000000 
\end{Soutput}
\end{Schunk}

		b) Arithmetic mean
\begin{Schunk}
\begin{Sinput}
> arithmeticMean <- function(set, usrTrim = 0) (mean(set, trim = usrTrim))
> arithmeticMean(radius)
\end{Sinput}
\begin{Soutput}
[1] 25.91667
\end{Soutput}
\end{Schunk}

		c) Measures of dispersion, where the following page was used as a reference for this section:
		http://iridl.ldeo.columbia.edu/dochelp/StatTutorial/Dispersion/index.html#Intro

			- RANGE:
\begin{Schunk}
\begin{Sinput}
> range <- function(set) {max(set) - min(set)}
> range(radius)
\end{Sinput}
\begin{Soutput}
[1] 29
\end{Soutput}
\end{Schunk}
			- STANDARD DEVIATION
\begin{Schunk}
\begin{Sinput}
> stdDeviation <- function(set) 
+ {
+    sd(set) * (sqrt((length(set) - 1) / length(set)))
+ }
> stdDeviation(radius)
\end{Sinput}
\begin{Soutput}
[1] 9.277736
\end{Soutput}
\end{Schunk}
			- VARIANCE:
\begin{Schunk}
\begin{Sinput}
> variance <- function(set) {var(set) * (length(set) - 1 / length(set))} 
> variance(radius)
\end{Sinput}
\begin{Soutput}
[1] 1118.993
\end{Soutput}
\end{Schunk}
			- ROOT MEAN SQUARE: 
\begin{Schunk}
\begin{Sinput}
> rootMeanSqr <- function(set) {sqrt(mean(set ^ 2))}
> rootMeanSqr(radius)
\end{Sinput}
\begin{Soutput}
[1] 27.52726
\end{Soutput}
\end{Schunk}
			- ROOT MEAN SQUARE ANOMALY:
\begin{Schunk}
\begin{Sinput}
> rootMeanSqrAn <- function(set) {sqrt(sum(set - mean(set)) ^ 2) / length(set)}
> rootMeanSqrAn(radius)
\end{Sinput}
\begin{Soutput}
[1] 1.184238e-15
\end{Soutput}
\end{Schunk}
			- INTERQUARTILE RANGE:
\begin{Schunk}
\begin{Sinput}
> interQuartRange <- function(set) {IQR(set)}
> interQuartRange(radius)
\end{Sinput}
\begin{Soutput}
[1] 14.25
\end{Soutput}
\end{Schunk}
			- MEDIAN ABSOLUTE DEVIATION
\begin{Schunk}
\begin{Sinput}
> medAbsDeviation <- function(set) {mad(set)}
> medAbsDeviation(radius)
\end{Sinput}
\begin{Soutput}
[1] 12.6021
\end{Soutput}
\end{Schunk}
		d) Finally, measures of order:
		
			-MEDIAN:
\begin{Schunk}
\begin{Sinput}
> getMedian    <- function(set) {median(set)}
> getMedian(radius)
\end{Sinput}
\begin{Soutput}
[1] 24.5
\end{Soutput}
\end{Schunk}
			-MODE:
\begin{Schunk}
\begin{Sinput}
> getMode      <- function(set) 
+ {
+     uniqueVal <- unique(set)
+     uniqueVal[which.max(tabulate(match(set, uniqueVal)))]
+ }
> getMode(radius)
\end{Sinput}
\begin{Soutput}
[1] 20
\end{Soutput}
\end{Schunk}
			-QUARTILES:
\begin{Schunk}
\begin{Sinput}
> getQuartiles <- function(set) {quantile(set)}
> getQuartiles(radius)
\end{Sinput}
\begin{Soutput}
   0%   25%   50%   75%  100% 
13.00 19.00 24.50 33.25 42.00 
\end{Soutput}
\end{Schunk}
			-54th QUANTILE:
\begin{Schunk}
\begin{Sinput}
> getQuantiles <- function(set, range = 0) {quantile(set, probs = range)}
> getQuantiles(radius)
\end{Sinput}
\begin{Soutput}
0% 
13 
\end{Soutput}
\end{Schunk}

	1.2 Now, the file will be "cardata.sav" where the same analyzes of data will be
	applied to mpg_agrupada. But this time, it is not necessary to calculate the 54th and the
	frequencies.
	
	It is necessary to import the foreign's library to read fata from SPSS files in R.
\begin{Schunk}
\begin{Sinput}
> library(foreign)
\end{Sinput}
\end{Schunk}
	Then, the file is read, only data related to mpg_agrupada is load into the variable mpg_agrupada
	and we use a filter to delete all unusefull data and group then.
\begin{Schunk}
\begin{Sinput}
> dataset = read.spss("cardata.sav", to.data.frame=TRUE)
> mpg_agrupada = dataset$mpg_agrupada
> mpg_agrupada = mpg_agrupada[!is.na(mpg_agrupada)]
> mpg_agrupada
\end{Sinput}
\begin{Soutput}
  [1] _duplicated_7  _duplicated_3  _duplicated_3  _duplicated_3  _duplicated_3  _duplicated_3 
  [7] _duplicated_3  _duplicated_4  _duplicated_3  _duplicated_3  _duplicated_3  _duplicated_3 
 [13] _duplicated_2  _duplicated_2  _duplicated_3  _duplicated_2  _duplicated_2  _duplicated_2 
 [19] _duplicated_6  _duplicated_6  _duplicated_4  _duplicated_4  _duplicated_3  _duplicated_3 
 [25] _duplicated_3  _duplicated_3  _duplicated_3  _duplicated_2  _duplicated_2  _duplicated_2 
 [31] _duplicated_2  _duplicated_2                 _duplicated_3  _duplicated_2  _duplicated_7 
 [37] _duplicated_5  _duplicated_4  _duplicated_4  _duplicated_7  _duplicated_7  _duplicated_5 
 [43] _duplicated_5  _duplicated_5  _duplicated_7  _duplicated_6  _duplicated_5  _duplicated_5 
 [49] _duplicated_4  _duplicated_3  _duplicated_5  _duplicated_4  _duplicated_5  _duplicated_5 
 [55] _duplicated_4  _duplicated_4  _duplicated_6  _duplicated_8  _duplicated_7  _duplicated_7 
 [61] _duplicated_6  _duplicated_3  _duplicated_5  _duplicated_3  _duplicated_2  _duplicated_5 
 [67] _duplicated_5  _duplicated_7  _duplicated_6  _duplicated_5  _duplicated_5  _duplicated_4 
 [73] _duplicated_4  _duplicated_8  _duplicated_7  _duplicated_4  _duplicated_8  _duplicated_5 
 [79] _duplicated_3  _duplicated_7  _duplicated_5  _duplicated_5  _duplicated_6  _duplicated_5 
 [85] _duplicated_6  _duplicated_9  _duplicated_3  _duplicated_2  _duplicated_3  _duplicated_2 
 [91] _duplicated_6  _duplicated_6  _duplicated_4  _duplicated_5  _duplicated_8  _duplicated_9 
 [97] _duplicated_7  _duplicated_10 _duplicated_10 _duplicated_8  _duplicated_6  _duplicated_9 
[103] _duplicated_6  _duplicated_7  _duplicated_7  _duplicated_7  _duplicated_5  _duplicated_6 
[109] _duplicated_7  _duplicated_10 _duplicated_7  _duplicated_8  _duplicated_7  _duplicated_5 
[115] _duplicated_5  _duplicated_3  _duplicated_4  _duplicated_6  _duplicated_7  _duplicated_6 
[121] _duplicated_8  _duplicated_8  _duplicated_6  _duplicated_6  _duplicated_8  _duplicated_6 
[127] _duplicated_10 _duplicated_9  _duplicated_10 _duplicated_7  _duplicated_6  _duplicated_4 
[133] _duplicated_6  _duplicated_8  _duplicated_7  _duplicated_6  _duplicated_8  _duplicated_8 
[139] _duplicated_7  _duplicated_7  _duplicated_6  _duplicated_7  _duplicated_6  _duplicated_4 
[145] _duplicated_4  _duplicated_8  _duplicated_6  _duplicated_7  _duplicated_7  _duplicated_7 
[151] _duplicated_8  _duplicated_6  _duplicated_8  _duplicated_6 
10 Levels:  _duplicated_2 _duplicated_3 _duplicated_4 _duplicated_5 _duplicated_6 ... _duplicated_10
\end{Soutput}
\end{Schunk}

	Now, data is ready to be analyzes so we can use the same functions as it has been used 
	in the previous section.
	
ABSOLUTE FRECUENCY:
\begin{Schunk}
\begin{Sinput}
> absoluteFreq(mpg_agrupada)
\end{Sinput}
\begin{Soutput}
set
                _duplicated_2  _duplicated_3  _duplicated_4  _duplicated_5  _duplicated_6 
             1             14             24             17             22             26 
 _duplicated_7  _duplicated_8  _duplicated_9 _duplicated_10 
            26             15              4              5 
\end{Soutput}
\end{Schunk}

		b) Arithmetic mean
\begin{Schunk}
\begin{Sinput}
> arithmeticMean(mpg_agrupada)
\end{Sinput}
\begin{Soutput}
[1] NA
\end{Soutput}
\end{Schunk}

		c) Measures of dispersion, where the following page was used as a reference for this section:
		http://iridl.ldeo.columbia.edu/dochelp/StatTutorial/Dispersion/index.html#Intro

			- RANGE:
\begin{Schunk}
\begin{Sinput}
> range(mpg_agrupada)